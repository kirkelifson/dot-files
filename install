#!/bin/bash

set -e
cwd=$(pwd -P) # current working directory

# Begin installation:
echo -e "Installing dot-files:"
echo -e "\t[+] Creating soft-links to dot-files."

# Backup directories
if [[ -d ~/.zsh ]];
then
    mv ~/.zsh ~/.zsh-backup
fi

if [[ -d ~/.vim ]];
then
    mv ~/.vim ~/.vim-backup
fi

# Soft-link all files and directories (except .git of course)
for dotfile in $(find $(pwd) -maxdepth 1 -name ".*" | sed '/.git/d');
do
    ln -sf $dotfile ~
done

# Only copy update script on debian
if [[ `uname -s` == "Linux" ]];
then
    ln -sf update ~
fi

# Install vundle
if [[ ! -d ~/.vim/bundle/vundle ]]; then
    echo -e "\t[+] Installing vundle."
    git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle &> /dev/null
fi

echo -e "\t[+] Installing new vundles."
vim +PluginInstall +qall

echo -e "[!] Restart terminal session for changes to take effect."
